{"version":3,"names":["gql","aggregatedPublicationInfo","canLockUnlock","childNodeTypes","contentRestrictions","displayableNode","displayName","getProperties","installedModules","isExternal","lockInfo","mimeTypes","nodeCacheRequiredFields","operationSupport","parentNode","primaryNodeType","replaceFragmentsInDocument","siteLanguages","getPermissionFragment","getSitePermissionFragment","getNodeTypeFragment","getSubNodesCountFragment","getBaseQueryAndVariables","variables","paths","baseQuery","_templateObject","_taggedTemplateLiteral","generatedVariables","skip","uuid","length","_templateObject2","uuids","_templateObject3","_templateObject4","path","validOptions","getQuery","options","arguments","undefined","fragments","_getBaseQueryAndVaria","getDisplayName","push","language","Error","getPrimaryNodeType","displayLanguage","displayLanguageSet","getParent","getAggregatedPublicationInfo","aggregatedPublicationInfoSubNodes","Boolean","subNodes","aggregatedPublicationInfoIncludeReference","reference","getOperationSupport","getPermissions","forEach","name","_getPermissionFragmen","fragment","fragmentVariables","Object","assign","getSitePermissions","_getSitePermissionFra","getIsNodeTypes","_getNodeTypeFragment","getPropertiesNames","getSiteInstalledModules","getSiteLanguages","getDisplayableNodePath","getLockInfo","getCanLockUnlock","getChildNodeTypes","getContributeTypesRestrictions","getSubNodesCount","_getSubNodesCountFrag","getMimeType","applyFragment","query"],"sources":["useNodeInfo.gql-queries.ts"],"sourcesContent":["import gql from 'graphql-tag';\nimport {\n    aggregatedPublicationInfo,\n    canLockUnlock,\n    childNodeTypes,\n    contentRestrictions,\n    displayableNode,\n    displayName,\n    Fragment,\n    getProperties,\n    installedModules, isExternal,\n    lockInfo,\n    mimeTypes,\n    nodeCacheRequiredFields,\n    operationSupport,\n    parentNode,\n    primaryNodeType,\n    replaceFragmentsInDocument,\n    siteLanguages\n} from '../../fragments';\nimport {getPermissionFragment, getSitePermissionFragment} from '../../fragments/getPermissionFragment';\nimport {getNodeTypeFragment} from '../../fragments/getIsNodeTypeFragment';\nimport {DocumentNode} from 'graphql';\nimport {getSubNodesCountFragment} from '~/fragments/getSubNodesCountFragment';\n\nconst getBaseQueryAndVariables = (variables: {[key:string]: any}): {\n    baseQuery: DocumentNode,\n    generatedVariables:{[key:string]: unknown},\n    skip: boolean\n} => {\n    if (variables.paths) {\n        return {\n            baseQuery: gql`\n                query NodesByPathInfoQuery($paths:[String!]!) {\n                    jcr {\n                        nodesByPath(paths:$paths) {\n                            name\n                            ...node\n                            ...NodeCacheRequiredFields\n                            ...External\n                        }\n                    }\n                }\n                ${nodeCacheRequiredFields.gql}\n                ${isExternal.gql}\n            `,\n            generatedVariables: {\n                paths: variables.paths\n            },\n            skip: false\n        };\n    }\n\n    if (variables.uuid && variables.uuid.length > 0) {\n        return {\n            baseQuery: gql`\n                query NodeByUuidInfoQuery($uuid:String!) {\n                    jcr {\n                        nodeById(uuid:$uuid) {\n                            name\n                            ...node\n                            ...NodeCacheRequiredFields\n                            ...External\n                        }\n                    }\n                }\n                ${nodeCacheRequiredFields.gql}\n                ${isExternal.gql}\n            `,\n            generatedVariables: {\n                uuid: variables.uuid\n            },\n            skip: false\n        };\n    }\n\n    if (variables.uuids) {\n        return {\n            baseQuery: gql`\n                query NodesByUuidInfoQuery($uuids:[String!]!) {\n                    jcr {\n                        nodesById(uuids:$uuids) {\n                            name\n                            ...node\n                            ...NodeCacheRequiredFields\n                            ...External\n                        }\n                    }\n                }\n                ${nodeCacheRequiredFields.gql}\n                ${isExternal.gql}\n            `,\n            generatedVariables: {\n                uuids: variables.uuids\n            },\n            skip: false\n        };\n    }\n\n    return {\n        baseQuery: gql`\n            query NodeByPathInfoQuery($path:String!) {\n                jcr {\n                    nodeByPath(path:$path) {\n                        name\n                        ...node\n                        ...NodeCacheRequiredFields\n                        ...External\n                    }\n                }\n            }\n            ${nodeCacheRequiredFields.gql}\n            ${isExternal.gql}\n        `,\n        generatedVariables: {\n            path: variables.path\n        },\n        skip: !variables.path || variables.path.length === 0\n    };\n};\n\nexport type NodeInfoOptions = Partial<{\n    getDisplayName: boolean,\n    getPrimaryNodeType: boolean,\n    getParent: boolean,\n    getAggregatedPublicationInfo: {\n        subNodes: boolean, reference: boolean\n    },\n    getOperationSupport: boolean,\n    getPermissions: string[],\n    getSitePermissions: string[],\n    getIsNodeTypes: string[],\n    getProperties: string[],\n    getSiteInstalledModules: boolean,\n    getSiteLanguages: boolean,\n    getDisplayableNodePath: boolean,\n    getLockInfo: boolean,\n    getCanLockUnlock: boolean,\n    getChildNodeTypes: boolean,\n    getContributeTypesRestrictions: boolean,\n    getSubNodesCount: string[],\n    getMimeType: boolean,\n    applyFragment: Fragment\n}>;\n\nexport const validOptions = [\n    'getDisplayName',\n    'getPrimaryNodeType',\n    'getParent',\n    'getAggregatedPublicationInfo',\n    'getOperationSupport',\n    'getPermissions',\n    'getSitePermissions',\n    'getIsNodeTypes',\n    'getProperties',\n    'getSiteInstalledModules',\n    'getSiteLanguages',\n    'getDisplayableNodePath',\n    'getLockInfo',\n    'getCanLockUnlock',\n    'getChildNodeTypes',\n    'getContributeTypesRestrictions',\n    'getSubNodesCount',\n    'getMimeType',\n    'applyFragment'\n];\n\nexport const getQuery = (variables: {[key:string]: any}, options: NodeInfoOptions = {}) => {\n    const fragments = [];\n\n    const {baseQuery, generatedVariables, skip} = getBaseQueryAndVariables(variables);\n\n    if (!skip) {\n        if (options.getDisplayName) {\n            fragments.push(displayName);\n            if (!variables.language) {\n                throw Error('language is required');\n            }\n\n            generatedVariables.language = variables.language;\n        }\n\n        if (options.getPrimaryNodeType) {\n            fragments.push(primaryNodeType);\n            if (variables.displayLanguage) {\n                generatedVariables.displayLanguageSet = true;\n                generatedVariables.displayLanguage = variables.displayLanguage;\n            } else {\n                generatedVariables.displayLanguageSet = false;\n                generatedVariables.displayLanguage = '';\n            }\n        }\n\n        if (options.getParent) {\n            fragments.push(parentNode);\n        }\n\n        if (options.getAggregatedPublicationInfo) {\n            fragments.push(aggregatedPublicationInfo);\n            if (!variables.language) {\n                throw Error('language is required');\n            }\n\n            generatedVariables.language = variables.language;\n            generatedVariables.aggregatedPublicationInfoSubNodes = Boolean(options.getAggregatedPublicationInfo.subNodes);\n            generatedVariables.aggregatedPublicationInfoIncludeReference = Boolean(options.getAggregatedPublicationInfo.reference);\n        }\n\n        if (options.getOperationSupport) {\n            fragments.push(operationSupport);\n        }\n\n        if (options.getPermissions) {\n            options.getPermissions.forEach(name => {\n                const {fragment, variables: fragmentVariables} = getPermissionFragment(name);\n                fragments.push(fragment);\n                Object.assign(generatedVariables, fragmentVariables);\n            });\n        }\n\n        if (options.getSitePermissions) {\n            options.getSitePermissions.forEach(name => {\n                const {fragment, variables: fragmentVariables} = getSitePermissionFragment(name);\n                fragments.push(fragment);\n                Object.assign(generatedVariables, fragmentVariables);\n            });\n        }\n\n        if (options.getIsNodeTypes) {\n            options.getIsNodeTypes.forEach(name => {\n                const {fragment, variables: fragmentVariables} = getNodeTypeFragment(name);\n                fragments.push(fragment);\n                Object.assign(generatedVariables, fragmentVariables);\n            });\n        }\n\n        if (options.getProperties) {\n            fragments.push(getProperties);\n            generatedVariables.getPropertiesNames = options.getProperties;\n\n            if (!variables.language) {\n                throw Error('language is required');\n            }\n\n            generatedVariables.language = variables.language;\n        }\n\n        if (options.getSiteInstalledModules) {\n            fragments.push(installedModules);\n        }\n\n        if (options.getSiteLanguages) {\n            fragments.push(siteLanguages);\n        }\n\n        if (options.getDisplayableNodePath) {\n            fragments.push(displayableNode);\n        }\n\n        if (options.getLockInfo) {\n            fragments.push(lockInfo);\n        }\n\n        if (options.getCanLockUnlock) {\n            fragments.push(canLockUnlock);\n        }\n\n        if (options.getChildNodeTypes) {\n            fragments.push(childNodeTypes);\n        }\n\n        if (options.getContributeTypesRestrictions) {\n            fragments.push(contentRestrictions);\n        }\n\n        if (options.getSubNodesCount) {\n            options.getSubNodesCount.forEach(name => {\n                const {fragment, variables: fragmentVariables} = getSubNodesCountFragment(name);\n                fragments.push(fragment);\n                Object.assign(generatedVariables, fragmentVariables);\n            });\n        }\n\n        if (options.getMimeType) {\n            fragments.push(mimeTypes);\n        }\n\n        if (options.applyFragment) {\n            fragments.push(options.applyFragment);\n        }\n    }\n\n    return {\n        query: replaceFragmentsInDocument(baseQuery, fragments),\n        generatedVariables,\n        skip\n    };\n};\n"],"mappings":"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","ignoreList":[]}