{"version":3,"names":["_graphqlTag","_interopRequireDefault","require","_fragments","_getPermissionFragment","_getIsNodeTypeFragment","_getSubNodesCountFragment","_templateObject","_templateObject2","_templateObject3","_templateObject4","getBaseQueryAndVariables","variables","paths","baseQuery","gql","_taggedTemplateLiteral2","nodeCacheRequiredFields","isExternal","generatedVariables","skip","uuid","length","uuids","path","validOptions","exports","getQuery","options","arguments","undefined","fragments","_getBaseQueryAndVaria","getDisplayName","push","displayName","language","Error","getPrimaryNodeType","primaryNodeType","displayLanguage","displayLanguageSet","getParent","parentNode","getAggregatedPublicationInfo","aggregatedPublicationInfo","aggregatedPublicationInfoSubNodes","Boolean","subNodes","aggregatedPublicationInfoIncludeReference","reference","getOperationSupport","operationSupport","getPermissions","forEach","name","_getPermissionFragmen","getPermissionFragment","fragment","fragmentVariables","Object","assign","getSitePermissions","_getSitePermissionFra","getSitePermissionFragment","getIsNodeTypes","_getNodeTypeFragment","getNodeTypeFragment","getProperties","getPropertiesNames","getSiteInstalledModules","installedModules","getSiteLanguages","siteLanguages","getDisplayableNodePath","displayableNode","getLockInfo","lockInfo","getCanLockUnlock","canLockUnlock","getChildNodeTypes","childNodeTypes","getContributeTypesRestrictions","contentRestrictions","getSubNodesCount","_getSubNodesCountFrag","getSubNodesCountFragment","getMimeType","mimeTypes","applyFragment","query","replaceFragmentsInDocument"],"sources":["useNodeInfo.gql-queries.ts"],"sourcesContent":["import gql from 'graphql-tag';\nimport {\n    aggregatedPublicationInfo,\n    canLockUnlock,\n    childNodeTypes,\n    contentRestrictions,\n    displayableNode,\n    displayName,\n    Fragment,\n    getProperties,\n    installedModules, isExternal,\n    lockInfo,\n    mimeTypes,\n    nodeCacheRequiredFields,\n    operationSupport,\n    parentNode,\n    primaryNodeType,\n    replaceFragmentsInDocument,\n    siteLanguages\n} from '../../fragments';\nimport {getPermissionFragment, getSitePermissionFragment} from '../../fragments/getPermissionFragment';\nimport {getNodeTypeFragment} from '../../fragments/getIsNodeTypeFragment';\nimport {DocumentNode} from 'graphql';\nimport {getSubNodesCountFragment} from '~/fragments/getSubNodesCountFragment';\n\nconst getBaseQueryAndVariables = (variables: {[key:string]: any}): {\n    baseQuery: DocumentNode,\n    generatedVariables:{[key:string]: unknown},\n    skip: boolean\n} => {\n    if (variables.paths) {\n        return {\n            baseQuery: gql`\n                query NodesByPathInfoQuery($paths:[String!]!) {\n                    jcr {\n                        nodesByPath(paths:$paths) {\n                            name\n                            ...node\n                            ...NodeCacheRequiredFields\n                            ...External\n                        }\n                    }\n                }\n                ${nodeCacheRequiredFields.gql}\n                ${isExternal.gql}\n            `,\n            generatedVariables: {\n                paths: variables.paths\n            },\n            skip: false\n        };\n    }\n\n    if (variables.uuid && variables.uuid.length > 0) {\n        return {\n            baseQuery: gql`\n                query NodeByUuidInfoQuery($uuid:String!) {\n                    jcr {\n                        nodeById(uuid:$uuid) {\n                            name\n                            ...node\n                            ...NodeCacheRequiredFields\n                            ...External\n                        }\n                    }\n                }\n                ${nodeCacheRequiredFields.gql}\n                ${isExternal.gql}\n            `,\n            generatedVariables: {\n                uuid: variables.uuid\n            },\n            skip: false\n        };\n    }\n\n    if (variables.uuids) {\n        return {\n            baseQuery: gql`\n                query NodesByUuidInfoQuery($uuids:[String!]!) {\n                    jcr {\n                        nodesById(uuids:$uuids) {\n                            name\n                            ...node\n                            ...NodeCacheRequiredFields\n                            ...External\n                        }\n                    }\n                }\n                ${nodeCacheRequiredFields.gql}\n                ${isExternal.gql}\n            `,\n            generatedVariables: {\n                uuids: variables.uuids\n            },\n            skip: false\n        };\n    }\n\n    return {\n        baseQuery: gql`\n            query NodeByPathInfoQuery($path:String!) {\n                jcr {\n                    nodeByPath(path:$path) {\n                        name\n                        ...node\n                        ...NodeCacheRequiredFields\n                        ...External\n                    }\n                }\n            }\n            ${nodeCacheRequiredFields.gql}\n            ${isExternal.gql}\n        `,\n        generatedVariables: {\n            path: variables.path\n        },\n        skip: !variables.path || variables.path.length === 0\n    };\n};\n\nexport type NodeInfoOptions = Partial<{\n    getDisplayName: boolean,\n    getPrimaryNodeType: boolean,\n    getParent: boolean,\n    getAggregatedPublicationInfo: {\n        subNodes: boolean, reference: boolean\n    },\n    getOperationSupport: boolean,\n    getPermissions: string[],\n    getSitePermissions: string[],\n    getIsNodeTypes: string[],\n    getProperties: string[],\n    getSiteInstalledModules: boolean,\n    getSiteLanguages: boolean,\n    getDisplayableNodePath: boolean,\n    getLockInfo: boolean,\n    getCanLockUnlock: boolean,\n    getChildNodeTypes: boolean,\n    getContributeTypesRestrictions: boolean,\n    getSubNodesCount: string[],\n    getMimeType: boolean,\n    applyFragment: Fragment\n}>;\n\nexport const validOptions = [\n    'getDisplayName',\n    'getPrimaryNodeType',\n    'getParent',\n    'getAggregatedPublicationInfo',\n    'getOperationSupport',\n    'getPermissions',\n    'getSitePermissions',\n    'getIsNodeTypes',\n    'getProperties',\n    'getSiteInstalledModules',\n    'getSiteLanguages',\n    'getDisplayableNodePath',\n    'getLockInfo',\n    'getCanLockUnlock',\n    'getChildNodeTypes',\n    'getContributeTypesRestrictions',\n    'getSubNodesCount',\n    'getMimeType',\n    'applyFragment'\n];\n\nexport const getQuery = (variables: {[key:string]: any}, options: NodeInfoOptions = {}) => {\n    const fragments = [];\n\n    const {baseQuery, generatedVariables, skip} = getBaseQueryAndVariables(variables);\n\n    if (!skip) {\n        if (options.getDisplayName) {\n            fragments.push(displayName);\n            if (!variables.language) {\n                throw Error('language is required');\n            }\n\n            generatedVariables.language = variables.language;\n        }\n\n        if (options.getPrimaryNodeType) {\n            fragments.push(primaryNodeType);\n            if (variables.displayLanguage) {\n                generatedVariables.displayLanguageSet = true;\n                generatedVariables.displayLanguage = variables.displayLanguage;\n            } else {\n                generatedVariables.displayLanguageSet = false;\n                generatedVariables.displayLanguage = '';\n            }\n        }\n\n        if (options.getParent) {\n            fragments.push(parentNode);\n        }\n\n        if (options.getAggregatedPublicationInfo) {\n            fragments.push(aggregatedPublicationInfo);\n            if (!variables.language) {\n                throw Error('language is required');\n            }\n\n            generatedVariables.language = variables.language;\n            generatedVariables.aggregatedPublicationInfoSubNodes = Boolean(options.getAggregatedPublicationInfo.subNodes);\n            generatedVariables.aggregatedPublicationInfoIncludeReference = Boolean(options.getAggregatedPublicationInfo.reference);\n        }\n\n        if (options.getOperationSupport) {\n            fragments.push(operationSupport);\n        }\n\n        if (options.getPermissions) {\n            options.getPermissions.forEach(name => {\n                const {fragment, variables: fragmentVariables} = getPermissionFragment(name);\n                fragments.push(fragment);\n                Object.assign(generatedVariables, fragmentVariables);\n            });\n        }\n\n        if (options.getSitePermissions) {\n            options.getSitePermissions.forEach(name => {\n                const {fragment, variables: fragmentVariables} = getSitePermissionFragment(name);\n                fragments.push(fragment);\n                Object.assign(generatedVariables, fragmentVariables);\n            });\n        }\n\n        if (options.getIsNodeTypes) {\n            options.getIsNodeTypes.forEach(name => {\n                const {fragment, variables: fragmentVariables} = getNodeTypeFragment(name);\n                fragments.push(fragment);\n                Object.assign(generatedVariables, fragmentVariables);\n            });\n        }\n\n        if (options.getProperties) {\n            fragments.push(getProperties);\n            generatedVariables.getPropertiesNames = options.getProperties;\n\n            if (!variables.language) {\n                throw Error('language is required');\n            }\n\n            generatedVariables.language = variables.language;\n        }\n\n        if (options.getSiteInstalledModules) {\n            fragments.push(installedModules);\n        }\n\n        if (options.getSiteLanguages) {\n            fragments.push(siteLanguages);\n        }\n\n        if (options.getDisplayableNodePath) {\n            fragments.push(displayableNode);\n        }\n\n        if (options.getLockInfo) {\n            fragments.push(lockInfo);\n        }\n\n        if (options.getCanLockUnlock) {\n            fragments.push(canLockUnlock);\n        }\n\n        if (options.getChildNodeTypes) {\n            fragments.push(childNodeTypes);\n        }\n\n        if (options.getContributeTypesRestrictions) {\n            fragments.push(contentRestrictions);\n        }\n\n        if (options.getSubNodesCount) {\n            options.getSubNodesCount.forEach(name => {\n                const {fragment, variables: fragmentVariables} = getSubNodesCountFragment(name);\n                fragments.push(fragment);\n                Object.assign(generatedVariables, fragmentVariables);\n            });\n        }\n\n        if (options.getMimeType) {\n            fragments.push(mimeTypes);\n        }\n\n        if (options.applyFragment) {\n            fragments.push(options.applyFragment);\n        }\n    }\n\n    return {\n        query: replaceFragmentsInDocument(baseQuery, fragments),\n        generatedVariables,\n        skip\n    };\n};\n"],"mappings":";;;;;;;;AAAA,IAAAA,WAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,UAAA,GAAAD,OAAA;AAmBA,IAAAE,sBAAA,GAAAF,OAAA;AACA,IAAAG,sBAAA,GAAAH,OAAA;AAEA,IAAAI,yBAAA,GAAAJ,OAAA;AAA8E,IAAAK,eAAA,EAAAC,gBAAA,EAAAC,gBAAA,EAAAC,gBAAA;AAE9E,IAAMC,wBAAwB,GAAG,SAA3BA,wBAAwBA,CAAIC,SAA8B,EAI3D;EACD,IAAIA,SAAS,CAACC,KAAK,EAAE;IACjB,OAAO;MACHC,SAAS,MAAEC,sBAAG,EAAAR,eAAA,KAAAA,eAAA,OAAAS,uBAAA,6cAWRC,kCAAuB,CAACF,GAAG,EAC3BG,qBAAU,CAACH,GAAG,CACnB;MACDI,kBAAkB,EAAE;QAChBN,KAAK,EAAED,SAAS,CAACC;MACrB,CAAC;MACDO,IAAI,EAAE;IACV,CAAC;EACL;EAEA,IAAIR,SAAS,CAACS,IAAI,IAAIT,SAAS,CAACS,IAAI,CAACC,MAAM,GAAG,CAAC,EAAE;IAC7C,OAAO;MACHR,SAAS,MAAEC,sBAAG,EAAAP,gBAAA,KAAAA,gBAAA,OAAAQ,uBAAA,mcAWRC,kCAAuB,CAACF,GAAG,EAC3BG,qBAAU,CAACH,GAAG,CACnB;MACDI,kBAAkB,EAAE;QAChBE,IAAI,EAAET,SAAS,CAACS;MACpB,CAAC;MACDD,IAAI,EAAE;IACV,CAAC;EACL;EAEA,IAAIR,SAAS,CAACW,KAAK,EAAE;IACjB,OAAO;MACHT,SAAS,MAAEC,sBAAG,EAAAN,gBAAA,KAAAA,gBAAA,OAAAO,uBAAA,2cAWRC,kCAAuB,CAACF,GAAG,EAC3BG,qBAAU,CAACH,GAAG,CACnB;MACDI,kBAAkB,EAAE;QAChBI,KAAK,EAAEX,SAAS,CAACW;MACrB,CAAC;MACDH,IAAI,EAAE;IACV,CAAC;EACL;EAEA,OAAO;IACHN,SAAS,MAAEC,sBAAG,EAAAL,gBAAA,KAAAA,gBAAA,OAAAM,uBAAA,iZAWRC,kCAAuB,CAACF,GAAG,EAC3BG,qBAAU,CAACH,GAAG,CACnB;IACDI,kBAAkB,EAAE;MAChBK,IAAI,EAAEZ,SAAS,CAACY;IACpB,CAAC;IACDJ,IAAI,EAAE,CAACR,SAAS,CAACY,IAAI,IAAIZ,SAAS,CAACY,IAAI,CAACF,MAAM,KAAK;EACvD,CAAC;AACL,CAAC;AA0BM,IAAMG,YAAY,GAAAC,OAAA,CAAAD,YAAA,GAAG,CACxB,gBAAgB,EAChB,oBAAoB,EACpB,WAAW,EACX,8BAA8B,EAC9B,qBAAqB,EACrB,gBAAgB,EAChB,oBAAoB,EACpB,gBAAgB,EAChB,eAAe,EACf,yBAAyB,EACzB,kBAAkB,EAClB,wBAAwB,EACxB,aAAa,EACb,kBAAkB,EAClB,mBAAmB,EACnB,gCAAgC,EAChC,kBAAkB,EAClB,aAAa,EACb,eAAe,CAClB;AAEM,IAAME,QAAQ,GAAAD,OAAA,CAAAC,QAAA,GAAG,SAAXA,QAAQA,CAAIf,SAA8B,EAAoC;EAAA,IAAlCgB,OAAwB,GAAAC,SAAA,CAAAP,MAAA,QAAAO,SAAA,QAAAC,SAAA,GAAAD,SAAA,MAAG,CAAC,CAAC;EAClF,IAAME,SAAS,GAAG,EAAE;EAEpB,IAAAC,qBAAA,GAA8CrB,wBAAwB,CAACC,SAAS,CAAC;IAA1EE,SAAS,GAAAkB,qBAAA,CAATlB,SAAS;IAAEK,kBAAkB,GAAAa,qBAAA,CAAlBb,kBAAkB;IAAEC,IAAI,GAAAY,qBAAA,CAAJZ,IAAI;EAE1C,IAAI,CAACA,IAAI,EAAE;IACP,IAAIQ,OAAO,CAACK,cAAc,EAAE;MACxBF,SAAS,CAACG,IAAI,CAACC,sBAAW,CAAC;MAC3B,IAAI,CAACvB,SAAS,CAACwB,QAAQ,EAAE;QACrB,MAAMC,KAAK,CAAC,sBAAsB,CAAC;MACvC;MAEAlB,kBAAkB,CAACiB,QAAQ,GAAGxB,SAAS,CAACwB,QAAQ;IACpD;IAEA,IAAIR,OAAO,CAACU,kBAAkB,EAAE;MAC5BP,SAAS,CAACG,IAAI,CAACK,0BAAe,CAAC;MAC/B,IAAI3B,SAAS,CAAC4B,eAAe,EAAE;QAC3BrB,kBAAkB,CAACsB,kBAAkB,GAAG,IAAI;QAC5CtB,kBAAkB,CAACqB,eAAe,GAAG5B,SAAS,CAAC4B,eAAe;MAClE,CAAC,MAAM;QACHrB,kBAAkB,CAACsB,kBAAkB,GAAG,KAAK;QAC7CtB,kBAAkB,CAACqB,eAAe,GAAG,EAAE;MAC3C;IACJ;IAEA,IAAIZ,OAAO,CAACc,SAAS,EAAE;MACnBX,SAAS,CAACG,IAAI,CAACS,qBAAU,CAAC;IAC9B;IAEA,IAAIf,OAAO,CAACgB,4BAA4B,EAAE;MACtCb,SAAS,CAACG,IAAI,CAACW,oCAAyB,CAAC;MACzC,IAAI,CAACjC,SAAS,CAACwB,QAAQ,EAAE;QACrB,MAAMC,KAAK,CAAC,sBAAsB,CAAC;MACvC;MAEAlB,kBAAkB,CAACiB,QAAQ,GAAGxB,SAAS,CAACwB,QAAQ;MAChDjB,kBAAkB,CAAC2B,iCAAiC,GAAGC,OAAO,CAACnB,OAAO,CAACgB,4BAA4B,CAACI,QAAQ,CAAC;MAC7G7B,kBAAkB,CAAC8B,yCAAyC,GAAGF,OAAO,CAACnB,OAAO,CAACgB,4BAA4B,CAACM,SAAS,CAAC;IAC1H;IAEA,IAAItB,OAAO,CAACuB,mBAAmB,EAAE;MAC7BpB,SAAS,CAACG,IAAI,CAACkB,2BAAgB,CAAC;IACpC;IAEA,IAAIxB,OAAO,CAACyB,cAAc,EAAE;MACxBzB,OAAO,CAACyB,cAAc,CAACC,OAAO,CAAC,UAAAC,IAAI,EAAI;QACnC,IAAAC,qBAAA,GAAiD,IAAAC,4CAAqB,EAACF,IAAI,CAAC;UAArEG,QAAQ,GAAAF,qBAAA,CAARE,QAAQ;UAAaC,iBAAiB,GAAAH,qBAAA,CAA5B5C,SAAS;QAC1BmB,SAAS,CAACG,IAAI,CAACwB,QAAQ,CAAC;QACxBE,MAAM,CAACC,MAAM,CAAC1C,kBAAkB,EAAEwC,iBAAiB,CAAC;MACxD,CAAC,CAAC;IACN;IAEA,IAAI/B,OAAO,CAACkC,kBAAkB,EAAE;MAC5BlC,OAAO,CAACkC,kBAAkB,CAACR,OAAO,CAAC,UAAAC,IAAI,EAAI;QACvC,IAAAQ,qBAAA,GAAiD,IAAAC,gDAAyB,EAACT,IAAI,CAAC;UAAzEG,QAAQ,GAAAK,qBAAA,CAARL,QAAQ;UAAaC,iBAAiB,GAAAI,qBAAA,CAA5BnD,SAAS;QAC1BmB,SAAS,CAACG,IAAI,CAACwB,QAAQ,CAAC;QACxBE,MAAM,CAACC,MAAM,CAAC1C,kBAAkB,EAAEwC,iBAAiB,CAAC;MACxD,CAAC,CAAC;IACN;IAEA,IAAI/B,OAAO,CAACqC,cAAc,EAAE;MACxBrC,OAAO,CAACqC,cAAc,CAACX,OAAO,CAAC,UAAAC,IAAI,EAAI;QACnC,IAAAW,oBAAA,GAAiD,IAAAC,0CAAmB,EAACZ,IAAI,CAAC;UAAnEG,QAAQ,GAAAQ,oBAAA,CAARR,QAAQ;UAAaC,iBAAiB,GAAAO,oBAAA,CAA5BtD,SAAS;QAC1BmB,SAAS,CAACG,IAAI,CAACwB,QAAQ,CAAC;QACxBE,MAAM,CAACC,MAAM,CAAC1C,kBAAkB,EAAEwC,iBAAiB,CAAC;MACxD,CAAC,CAAC;IACN;IAEA,IAAI/B,OAAO,CAACwC,aAAa,EAAE;MACvBrC,SAAS,CAACG,IAAI,CAACkC,wBAAa,CAAC;MAC7BjD,kBAAkB,CAACkD,kBAAkB,GAAGzC,OAAO,CAACwC,aAAa;MAE7D,IAAI,CAACxD,SAAS,CAACwB,QAAQ,EAAE;QACrB,MAAMC,KAAK,CAAC,sBAAsB,CAAC;MACvC;MAEAlB,kBAAkB,CAACiB,QAAQ,GAAGxB,SAAS,CAACwB,QAAQ;IACpD;IAEA,IAAIR,OAAO,CAAC0C,uBAAuB,EAAE;MACjCvC,SAAS,CAACG,IAAI,CAACqC,2BAAgB,CAAC;IACpC;IAEA,IAAI3C,OAAO,CAAC4C,gBAAgB,EAAE;MAC1BzC,SAAS,CAACG,IAAI,CAACuC,wBAAa,CAAC;IACjC;IAEA,IAAI7C,OAAO,CAAC8C,sBAAsB,EAAE;MAChC3C,SAAS,CAACG,IAAI,CAACyC,0BAAe,CAAC;IACnC;IAEA,IAAI/C,OAAO,CAACgD,WAAW,EAAE;MACrB7C,SAAS,CAACG,IAAI,CAAC2C,mBAAQ,CAAC;IAC5B;IAEA,IAAIjD,OAAO,CAACkD,gBAAgB,EAAE;MAC1B/C,SAAS,CAACG,IAAI,CAAC6C,wBAAa,CAAC;IACjC;IAEA,IAAInD,OAAO,CAACoD,iBAAiB,EAAE;MAC3BjD,SAAS,CAACG,IAAI,CAAC+C,yBAAc,CAAC;IAClC;IAEA,IAAIrD,OAAO,CAACsD,8BAA8B,EAAE;MACxCnD,SAAS,CAACG,IAAI,CAACiD,8BAAmB,CAAC;IACvC;IAEA,IAAIvD,OAAO,CAACwD,gBAAgB,EAAE;MAC1BxD,OAAO,CAACwD,gBAAgB,CAAC9B,OAAO,CAAC,UAAAC,IAAI,EAAI;QACrC,IAAA8B,qBAAA,GAAiD,IAAAC,kDAAwB,EAAC/B,IAAI,CAAC;UAAxEG,QAAQ,GAAA2B,qBAAA,CAAR3B,QAAQ;UAAaC,iBAAiB,GAAA0B,qBAAA,CAA5BzE,SAAS;QAC1BmB,SAAS,CAACG,IAAI,CAACwB,QAAQ,CAAC;QACxBE,MAAM,CAACC,MAAM,CAAC1C,kBAAkB,EAAEwC,iBAAiB,CAAC;MACxD,CAAC,CAAC;IACN;IAEA,IAAI/B,OAAO,CAAC2D,WAAW,EAAE;MACrBxD,SAAS,CAACG,IAAI,CAACsD,oBAAS,CAAC;IAC7B;IAEA,IAAI5D,OAAO,CAAC6D,aAAa,EAAE;MACvB1D,SAAS,CAACG,IAAI,CAACN,OAAO,CAAC6D,aAAa,CAAC;IACzC;EACJ;EAEA,OAAO;IACHC,KAAK,EAAE,IAAAC,qCAA0B,EAAC7E,SAAS,EAAEiB,SAAS,CAAC;IACvDZ,kBAAkB,EAAlBA,kBAAkB;IAClBC,IAAI,EAAJA;EACJ,CAAC;AACL,CAAC","ignoreList":[]}